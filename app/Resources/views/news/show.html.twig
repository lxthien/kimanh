{% extends 'layout.html.twig' %}

{% block stylesheets %}
    <link href="{{ asset('build/css/news.css') }}" rel="preload stylesheet" as="style" onload="this.rel='stylesheet'" >
    <link href="{{ asset('build/css/new.css') }}" rel="preload stylesheet" as="style" onload="this.rel='stylesheet'" >
    <noscript><link rel="stylesheet" href="{{ asset('build/css/news.css') }}" ></noscript>
    <noscript><link rel="stylesheet" href="{{ asset('build/css/new.css') }}" ></noscript>
{% endblock %}

{% block title %}{{ post.getPageTitle() is not null ? post.getPageTitle() : post.getTitle() }}{% endblock %}
{% block description %}{{ post.getPageDescription() is not null ? post.getPageDescription() : post.getDescription() }}{% endblock %}
{% block keyword %}{{ post.getPageKeyword() }}{% endblock %}

{% set imagePath = (vich_uploader_asset(post, 'imageFile') ? vich_uploader_asset(post, 'imageFile') : absolute_url(asset('assets/images/no-image.png'))) %}
{% set imagePathFilter = (vich_uploader_asset(post, 'imageFile') ? vich_uploader_asset(post, 'imageFile') : absolute_url(asset('assets/images/no-image.png'))) | imagine_filter('news_share_800_420') %}

{% if convert_images.fileExists(imagePath) == false %}
    {% set imagePath = imagePath | imagine_filter('news_share_800_420') %}
{% else %}
    {% set imagePath = convert_images.webpConvert(imagePathFilter, '', true) %}
{% endif %}

{% block structuredOpenGraph %}
    <link rel="amphtml" href="{{ url('amp_show', { slug: post.getUrl() }) }}">
    <meta property="og:type" content="article" />
    <meta property="og:title" content="{{ post.getPageTitle() is not null ? post.getPageTitle() : post.getTitle() }}" />
    <meta property="og:description" content="{{ post.getPageDescription() is not null ? post.getPageDescription() : post.getDescription() }}" />
    <meta property="og:image" content="{{ imagePath != false ? absolute_url(imagePath) : absolute_url(imagePathFilter) }}" />
    <meta property="og:image:alt" content="{{ post.getTitle() }}" />
    <meta property="og:image:width" content="800" />
    <meta property="og:image:height" content="420" />
{% endblock %}

{% block twitterImage %}
    <meta property="twitter:image" content="{{ imagePath != false ? absolute_url(imagePath) : absolute_url(imagePathFilter) }}" />
{% endblock %}

{% block structuredReview %}
    <script type="application/ld+json">
    {
        "@context": "https://schema.org/",
        "@type": "CreativeWorkSeries",
        "name": "{{ post.getTitle() }}",
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "{{ rating }}",
            "ratingCount": "{{ ratingCount ? ratingCount : 1 }}",
            "bestRating" : "5",
            "worstRating": "1"
        }
    }
    </script>
{% endblock %}

{% block contactHotline %}
    {% if post.getContactHotline() is empty %}
        <div class="hotline">
            <div class="inner">
                <a href="tel:0974776305"><div class="phonering-alo-ph-img-circle"></div>0974.776.305</a>
            </div>
        </div>
    {% else %}
        {{ post.getContactHotline()|raw }}
    {% endif %}
{% endblock %}

{% block body %}
    <div class="container wrapper-container page-detail">
        <div class="row">
            {# Side bar #}
            {{ include('layout/sidebar.html.twig') }}

            <div class="col-12 col-md-12 col-lg-9 page-detail-container">
                {# breadcrumbs #}
                {{ include('news/components/breadcrumbs.html.twig') }}

                <article id="post-{{ post.getId() }}" class="news" itemscope itemtype="http://schema.org/Article">
                    {# Begin google snippet #}
                    <meta itemscope itemprop="mainEntityOfPage" itemType="https://schema.org/WebPage" itemid="{{ absolute_url(path('news_show', {'slug': post.getUrl() })) }}"/>
                    <div itemprop="author" itemscope itemtype="https://schema.org/Person">
                        <meta itemprop="name" content="{{ get_setting('siteName') }}"/>
                        <meta itemprop="url" content="https://xaydungkimanh.business.site/"/>
                    </div>
                    <div itemprop="image" itemscope itemtype="https://schema.org/ImageObject">
                        <meta itemprop="url" content="{{ imagePath != false ? absolute_url(imagePath) : absolute_url(imagePathFilter) }}">
                        <meta itemprop="width" content="800">
                        <meta itemprop="height" content="420">
                    </div>
                    <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
                        <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
                            <meta itemprop="url" content="{{ asset(convert_images.webpConvert2(asset('/assets/images/logo.png'), '')) }}">
                            <meta itemprop="width" content="274">
                            <meta itemprop="height" content="99">
                        </div>
                        <meta itemprop="name" content="{{ get_setting('siteName') }}">
                    </div>
                    <meta itemprop="datePublished" content="{{ post.getCreatedAt()|date("Y-m-d h:m:s") ~ "+07:00" }}"/>
                    <meta itemprop="dateModified" content="{{ post.getUpdatedAt()|date("Y-m-d h:m:s") ~ "+07:00" }}"/>
                    {# End google snippet #}

                    <h1 class="entry-title block-title" itemprop="headline"><a href="#">{{ post.getTitle() }}</a></h1>

                    <div class="news-container" itemprop="articleBody">
                        {{ contentsLazy|replace({'50I Trần Thị Bảy, KP 3, Phường Hiệp Thành, Quận 12, TP Hồ Chí Minh':'C40 - KDC Hiệp Thành - Nguyễn Thị Búp, Phường Hiệp Thành, Quận 12, TP Hồ Chí Minh', '088.609.4455':'0966.289.559'})|raw }}
                    </div>

                    {# List tags #}
                    {{ include('news/components/tags.html.twig') }}

                    {# Rating and Share #}
                    <div class="rating-share-container">
                        {{ include('news/rating/rating.html.twig') }}
                        {# {{ include('news/components/share.html.twig') }} #}
                    </div>

                    {# Related news #}
                    {{ include('news/components/related.html.twig') }}
                    
                    {# List comments #}
                    {{ include('news/comments/list.html.twig') }}
                    
                    {# Render form comment #}
                    {{ include('news/comments/form.html.twig') }}
                </article>
            </div>
        </div>
    </div>
{% endblock %}